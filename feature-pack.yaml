name: audit-core
title: System Audit
description: Audit Core feature pack (global audit events + admin UI + embeddable audit trail)

# ─────────────────────────────────────────────────────────────────────────────
# ROUTES - Frontend page routes
# ─────────────────────────────────────────────────────────────────────────────
routes:
  - path: /admin/audit
    page: AuditLogList
    roles: []
    default_roles_allow: [admin]
    authz: { entity: auditEvents, verb: read, require_action: audit-core.audit-log.access, show_pages: true }

# ─────────────────────────────────────────────────────────────────────────────
# NAVIGATION - Sidebar/topbar items
# ─────────────────────────────────────────────────────────────────────────────
nav:
  - id: audit
    label: Audit Logs
    path: /admin/audit
    icon: ClipboardList
    group: system
    weight: 910
    showWhen: authenticated
    roles: [admin]

# ─────────────────────────────────────────────────────────────────────────────
# SCHEMA - Drizzle ORM table definitions
# ─────────────────────────────────────────────────────────────────────────────
schema:
  source: src/schema/audit.ts
  exports:
    - auditEvents
    - AuditActorType
    - AuditEvent
    - InsertAuditEvent

# ─────────────────────────────────────────────────────────────────────────────
# API ROUTES - Backend endpoints
# ─────────────────────────────────────────────────────────────────────────────
api:
  routes:
    - path: /api/audit
      methods: [GET]
      handler: "@hit/feature-pack-audit-core/server/api/audit"
      description: "List audit events (admin-only; filterable by entity kind/id, actor, action, correlation)"

# ─────────────────────────────────────────────────────────────────────────────
# CONFIG - Feature pack configuration options
# ─────────────────────────────────────────────────────────────────────────────
config:
  schema:
    auto_audit:
      type: boolean
      default: true
      description: "Automatically audit all write operations (POST/PUT/PATCH/DELETE) via dispatcher. When true, handlers don't need to call writeAuditEvent manually for basic audit coverage."

requires:
  modules: []

dependencies:
  feature_packs:
    - name: erp-shell-core

# ─────────────────────────────────────────────────────────────────────────────
# PERMISSIONS - Action definitions (for admin-core permissions UI + runtime checks)
# ─────────────────────────────────────────────────────────────────────────────
# Permissions are schema-driven and live under:
#   schema/permissions.yaml
